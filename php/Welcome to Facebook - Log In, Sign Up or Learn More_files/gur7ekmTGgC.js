/*!CK:541869899!*//*1412568397,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["x22Ob"]); }

__d("QuickSandSolver",["Base64","Form","QuickSandHeader","sha256"],function(a,b,c,d,e,f,g,h,i,j){var k={solveAndUpdateForm:function(l,m,n,o,p,q,r){var s=JSON.stringify([this.solve(l,m,n,o,p),r]),t=document.getElementById(q);h.createHiddenInputs({qsstamp:g.encode(s)},t);},solve:function(l,m,n,o,p){var q=[],r=m;for(var s=0;s<l;s++){q.push(k.solveOneIteration(r,n,o,p));r=k.hashList(q[s]);}return q;},solveOneIteration:function(l,m,n,o){var p=8192,q=new i(l,m),r=o*q.getSize()/100,s=[],t=[],u=[];for(var v=0;v<r;v++){var w=q.sipEdge(v),x=w[0],y=w[1];x+=1;y+=1+q.getHalfSize();var z=s[x],aa=s[y];if(z==y||aa==x)continue;t[0]=x;u[0]=y;var ba=k.path(z,t,s,p),ca=k.path(aa,u,s,p);if(t[ba]==u[ca]){var da=Math.min(ba,ca);for(ba-=da,ca-=da;t[ba]!=u[ca];ba++,ca++);var ea=ba+ca+1;if(ea==n)return k.recoverSolution(ba,ca,t,u,q,n,r);continue;}if(ba<ca){while(ba--)s[t[ba+1]]=t[ba];s[x]=y;}else{while(ca--)s[u[ca+1]]=u[ca];s[y]=x;}}return [];},path:function(l,m,n,o){var p=0;for(p=0;l;l=n[l]){if(++p>=o){while(p--&&m[p]!=l);if(p<0){throw "Maximum path length was exceeded";}else throw "Illegal cycle has occured";}m[p]=l;}return p;},recoverSolution:function(l,m,n,o,p,q,r){var s=function(){};s.prototype.add=function(y){this[y]=true;};s.prototype.remove=function(y){delete this[y];};var t=[],u=new s();u.add([n[0],o[0]]);while(l--)u.add([n[(l+1)&~1],n[(l|1)]]);while(m--)u.add([o[m|1],o[(m+1)&~1]]);var v=0;for(var w=0;w<r;w++){var x=[1+p.sipNode(w,0),1+p.getHalfSize()+p.sipNode(w,1)];if(x in u){t[v++]=w;u.remove(x);}}return t;},hashList:function(l){var m=l.join('-');return j(m);}};e.exports=k;},null);